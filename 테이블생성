/* ȸ�� */
CREATE TABLE member (
	m_no NUMBER NOT NULL, /* ����ȣ */
	id VARCHAR2(50) NOT NULL, /* ���̵� */
	name VARCHAR2(50) NOT NULL, /* �̸� */
	pwd VARCHAR2(72) NOT NULL, /* ��й�ȣ */
	email VARCHAR2(40) NOT NULL, /* �̸��� */
	addr VARCHAR2(255) /* �ּ� */
);

CREATE UNIQUE INDEX member
	ON member (
		m_no ASC
	);

ALTER TABLE member
	ADD
		CONSTRAINT member
		PRIMARY KEY (
			m_no
		);

/* �Խ��� */
CREATE TABLE board (
	b_no NUMBER NOT NULL, /* �Խ��ǹ�ȣ */
	b_title VARCHAR2(50), /* �Խ����̸� */
	b_regdate DATE /* ������ */
);

CREATE UNIQUE INDEX PK_board
	ON board (
		b_no ASC
	);

ALTER TABLE board
	ADD
		CONSTRAINT PK_board
		PRIMARY KEY (
			b_no
		);

/* ��ǰ */
CREATE TABLE goods (
	g_no NUMBER NOT NULL, /* ��ǰ��ȣ */
	c_no NUMBER, /* �з���ȣ */
	name VARCHAR2(50), /* ��ǰ�� */
	detail VARCHAR2(1000), /* �󼼼��� */
	stock NUMBER, /* ��� */
	purchase_price NUMBER, /* ���԰��� */
	sell_price NUMBER, /* �ǸŰ��� */
	discount_rate NUMBER, /* ������ */
	saving_mileage NUMBER, /* ���ϸ��� ������ */
	status NUMBER(1) /* ���� */
);

CREATE UNIQUE INDEX PK_goods
	ON goods (
		g_no ASC
	);

ALTER TABLE goods
	ADD
		CONSTRAINT PK_goods
		PRIMARY KEY (
			g_no
		);

/* �ֹ��� */
CREATE TABLE order_detail (
	od_no NUMBER NOT NULL, /* �ֹ��󼼹�ȣ */
	amount NUMBER, /* ���ż��� */
	total_price NUMBER, /* �ѱ��Ű��� */
	g_no NUMBER, /* ��ǰ��ȣ */
	o_no NUMBER /* �ֹ���ȣ */
);

CREATE UNIQUE INDEX PK_order_detail
	ON order_detail (
		od_no ASC
	);

ALTER TABLE order_detail
	ADD
		CONSTRAINT PK_order_detail
		PRIMARY KEY (
			od_no
		);

/* ��ǰ�ֹ� */
CREATE TABLE orders (
	o_no NUMBER NOT NULL, /* �ֹ���ȣ */
	m_no NUMBER, /* ����ȣ */
	total_price NUMBER, /* �ѱݾ� */
	pay VARCHAR2(5), /* ���� ��/�� */
	regdate DATE, /* ����� */
	recipient VARCHAR2(50), /* �޴»�� �̸� */
	addr VARCHAR2(255), /* �ּ� */
	message VARCHAR2(255) /* ��۸޽��� */
);

CREATE UNIQUE INDEX PK_orders
	ON orders (
		o_no ASC
	);

ALTER TABLE orders
	ADD
		CONSTRAINT PK_orders
		PRIMARY KEY (
			o_no
		);

/* ��ȸ�� */
CREATE TABLE non_member (
	nm_no NUMBER NOT NULL, /* ����ȣ */
	name VARCHAR2(50), /* �̸� */
	email VARCHAR2(40), /* �̸��� */
	pwd VARCHAR2(72) /* �ֹ���й�ȣ */
);

CREATE UNIQUE INDEX PK_non_member
	ON non_member (
		nm_no ASC
	);

ALTER TABLE non_member
	ADD
		CONSTRAINT PK_non_member
		PRIMARY KEY (
			nm_no
		);

/* ���� */
CREATE TABLE payment (
	o_no NUMBER NOT NULL, /* �ֹ���ȣ */
	price NUMBER, /* ������ �ݾ� */
	regdate DATE, /* ������ */
	py_no NUMBER /* �������ܹ�ȣ */
);

CREATE UNIQUE INDEX PK_payment
	ON payment (
		o_no ASC
	);

ALTER TABLE payment
	ADD
		CONSTRAINT PK_payment
		PRIMARY KEY (
			o_no
		);

/* ���ϸ��� */
CREATE TABLE mileage (
	m_no NUMBER NOT NULL, /* ����ȣ */
	m_date DATE NOT NULL, /* ������¥ */
	total_mileage NUMBER, /* ���� ���ϸ��� */
	change_amount NUMBER, /* ����/��� �� ���ϸ��� */
	reason VARCHAR2(150), /* ���� ���� */
	o_no NUMBER /* �ֹ���ȣ */
);

CREATE UNIQUE INDEX PK_mileage
	ON mileage (
		m_no ASC,
		m_date ASC
	);

ALTER TABLE mileage
	ADD
		CONSTRAINT PK_mileage
		PRIMARY KEY (
			m_no,
			m_date
		);

/* �ֹ�Ȯ�� */
CREATE TABLE order_check (
	o_no NUMBER NOT NULL, /* �ֹ���ȣ */
	status VARCHAR2(20), /* �ֹ����� */
	regdate DATE /* ó������ */
);

CREATE UNIQUE INDEX PK_order_check
	ON order_check (
		o_no ASC
	);

ALTER TABLE order_check
	ADD
		CONSTRAINT PK_order_check
		PRIMARY KEY (
			o_no
		);

/* �������� */
CREATE TABLE payment_way (
	py_no NUMBER NOT NULL, /* �������ܹ�ȣ */
	name VARCHAR2(30) /* �������ܸ� */
);

CREATE UNIQUE INDEX PK_payment_way
	ON payment_way (
		py_no ASC
	);

ALTER TABLE payment_way
	ADD
		CONSTRAINT PK_payment_way
		PRIMARY KEY (
			py_no
		);

/* �Խñ� */
CREATE TABLE post (
	p_no NUMBER NOT NULL, /* �۹�ȣ */
	p_title VARCHAR2(250), /* ���� */
	p_content VARCHAR2(2000), /* ���� */
	p_writer VARCHAR2(50), /* �ۼ��� */
	p_regdate DATE, /* ����� */
	b_no NUMBER /* �Խ��ǹ�ȣ */
);

CREATE UNIQUE INDEX PK_post
	ON post (
		p_no ASC
	);

ALTER TABLE post
	ADD
		CONSTRAINT PK_post
		PRIMARY KEY (
			p_no
		);

/* ��ٱ��� */
CREATE TABLE basket (
	m_no NUMBER NOT NULL, /* ����ȣ */
	g_no NUMBER NOT NULL, /* ��ǰ��ȣ */
	amount NUMBER /* ���� */
);

CREATE UNIQUE INDEX PK_basket
	ON basket (
		m_no ASC,
		g_no ASC
	);

ALTER TABLE basket
	ADD
		CONSTRAINT PK_basket
		PRIMARY KEY (
			m_no,
			g_no
		);

/* ȸ����� */
CREATE TABLE member_grade (
	m_no NUMBER NOT NULL, /* ����ȣ */
	mg_date DATE NOT NULL, /* ������¥ */
	grade NUMBER, /* ȸ����� */
	point NUMBER, /* ����Ʈ */
	reason VARCHAR2(150) /* �������� */
);

CREATE UNIQUE INDEX PK_member_grade
	ON member_grade (
		m_no ASC,
		mg_date ASC
	);

ALTER TABLE member_grade
	ADD
		CONSTRAINT PK_member_grade
		PRIMARY KEY (
			m_no,
			mg_date
		);

/* ���� */
CREATE TABLE files (
	f_no NUMBER NOT NULL, /* ���Ϲ�ȣ */
	name VARCHAR2(50), /* �����̸� */
	save_path VARCHAR2(255), /* ������ */
	regdate DATE /* ��ϳ�¥ */
);

CREATE UNIQUE INDEX PK_files
	ON files (
		f_no ASC
	);

ALTER TABLE files
	ADD
		CONSTRAINT PK_files
		PRIMARY KEY (
			f_no
		);

/* ��ǰ�̹��� */
CREATE TABLE goods_image (
	g_no NUMBER NOT NULL, /* ��ǰ��ȣ */
	f_no NUMBER NOT NULL, /* ���Ϲ�ȣ */
	location VARCHAR2(255) /* �̹��� ��ġ */
);

CREATE UNIQUE INDEX PK_goods_image
	ON goods_image (
		g_no ASC,
		f_no ASC
	);

ALTER TABLE goods_image
	ADD
		CONSTRAINT PK_goods_image
		PRIMARY KEY (
			g_no,
			f_no
		);

/* ������� */
CREATE TABLE shipping_receiving (
	sr_no NUMBER NOT NULL, /* ������ȣ */
	g_no NUMBER NOT NULL, /* ��ǰ��ȣ */
	category NUMBER(1), /* �з� */
	detail VARCHAR2(50), /* ���� */
	amount NUMBER, /* ���� */
	price NUMBER, /* �ܰ� */
	regdate DATE /* ��¥ */
);

CREATE UNIQUE INDEX PK_shipping_receiving
	ON shipping_receiving (
		sr_no ASC,
		g_no ASC
	);

ALTER TABLE shipping_receiving
	ADD
		CONSTRAINT PK_shipping_receiving
		PRIMARY KEY (
			sr_no,
			g_no
		);

/* �з� */
CREATE TABLE category (
	c_no NUMBER NOT NULL, /* �з���ȣ */
	title VARCHAR2(50), /* �з��� */
	parent_no NUMBER, /* �����з���ȣ */
	menu_level NUMBER, /* �з����� */
	in_use VARCHAR2(5) /* ��뿩�� */
);

CREATE UNIQUE INDEX PK_category
	ON category (
		c_no ASC
	);

ALTER TABLE category
	ADD
		CONSTRAINT PK_category
		PRIMARY KEY (
			c_no
		);

ALTER TABLE goods
	ADD
		CONSTRAINT FK_category_TO_goods
		FOREIGN KEY (
			c_no
		)
		REFERENCES category (
			c_no
		);

ALTER TABLE order_detail
	ADD
		CONSTRAINT FK_goods_TO_order_detail
		FOREIGN KEY (
			g_no
		)
		REFERENCES goods (
			g_no
		);

ALTER TABLE order_detail
	ADD
		CONSTRAINT FK_orders_TO_order_detail
		FOREIGN KEY (
			o_no
		)
		REFERENCES orders (
			o_no
		);

ALTER TABLE orders
	ADD
		CONSTRAINT FK_member_TO_orders
		FOREIGN KEY (
			m_no
		)
		REFERENCES member (
			m_no
		);

ALTER TABLE orders
	ADD
		CONSTRAINT FK_non_member_TO_orders
		FOREIGN KEY (
			m_no
		)
		REFERENCES non_member (
			nm_no
		);

ALTER TABLE payment
	ADD
		CONSTRAINT FK_payment_way_TO_payment
		FOREIGN KEY (
			py_no
		)
		REFERENCES payment_way (
			py_no
		);

ALTER TABLE payment
	ADD
		CONSTRAINT FK_orders_TO_payment
		FOREIGN KEY (
			o_no
		)
		REFERENCES orders (
			o_no
		);

ALTER TABLE mileage
	ADD
		CONSTRAINT FK_member_TO_mileage
		FOREIGN KEY (
			m_no
		)
		REFERENCES member (
			m_no
		);

ALTER TABLE mileage
	ADD
		CONSTRAINT FK_payment_TO_mileage
		FOREIGN KEY (
			o_no
		)
		REFERENCES payment (
			o_no
		);

ALTER TABLE order_check
	ADD
		CONSTRAINT FK_payment_TO_order_check
		FOREIGN KEY (
			o_no
		)
		REFERENCES payment (
			o_no
		);

ALTER TABLE post
	ADD
		CONSTRAINT FK_board_TO_post
		FOREIGN KEY (
			b_no
		)
		REFERENCES board (
			b_no
		);

ALTER TABLE basket
	ADD
		CONSTRAINT FK_member_TO_basket
		FOREIGN KEY (
			m_no
		)
		REFERENCES member (
			m_no
		);

ALTER TABLE basket
	ADD
		CONSTRAINT FK_goods_TO_basket
		FOREIGN KEY (
			g_no
		)
		REFERENCES goods (
			g_no
		);

ALTER TABLE member_grade
	ADD
		CONSTRAINT FK_member_TO_member_grade
		FOREIGN KEY (
			m_no
		)
		REFERENCES member (
			m_no
		);

ALTER TABLE goods_image
	ADD
		CONSTRAINT FK_goods_TO_goods_image
		FOREIGN KEY (
			g_no
		)
		REFERENCES goods (
			g_no
		);

ALTER TABLE goods_image
	ADD
		CONSTRAINT FK_files_TO_goods_image
		FOREIGN KEY (
			f_no
		)
		REFERENCES files (
			f_no
		);

ALTER TABLE shipping_receiving
	ADD
		CONSTRAINT FK_goods_TO_shipping_receiving
		FOREIGN KEY (
			g_no
		)
		REFERENCES goods (
			g_no
		);